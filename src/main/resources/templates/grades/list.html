<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Оценки - Журнал</title>
    <link th:replace="~{fragments :: styles}">
</head>
<body>
<div th:replace="~{fragments :: header}"></div>
<div th:replace="~{fragments :: nav}"></div>

<div class="container">
    <div class="content">
        <div class="page-header">
            <h1>Оценки студентов</h1>
            <a href="/grades/new" class="btn btn-success">+ Добавить оценку</a>
        </div>

        <div th:if="${message}" class="alert" th:text="${message}"></div>

        <div class="filter-form">
            <form method="get" action="/grades">
                <div class="form-group">
                    <label for="studentId">Студент</label>
                    <select id="studentId" name="studentId">
                        <option value="">Все студенты</option>
                        <option th:each="student : ${students}"
                                th:value="${student.id}"
                                th:text="${student.fullName}"
                                th:selected="${studentId != null and studentId == student.id}"></option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="subjectId">Предмет</label>
                    <select id="subjectId" name="subjectId">
                        <option value="">Все предметы</option>
                        <option th:each="subject : ${subjects}"
                                th:value="${subject.id}"
                                th:text="${subject.name}"
                                th:selected="${subjectId != null and subjectId == subject.id}"></option>
                    </select>
                </div>
                <button type="submit" class="btn">Фильтровать</button>
                <a href="/grades" class="btn">Сбросить</a>
            </form>
        </div>

        <div th:if="${grades != null and !grades.isEmpty()}">
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Студент</th>
                    <th>Предмет</th>
                    <th>Оценка</th>
                    <th>Дата</th>
                    <th>Комментарий</th>
                    <th>Действия</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="grade : ${grades}">
                    <td th:text="${grade.id}"></td>
                    <td th:text="${grade.student.fullName}"></td>
                    <td th:text="${grade.subject.name}"></td>
                    <td th:text="${grade.value}" class="grade-value"></td>
                    <td th:text="${#temporals.format(grade.date, 'dd.MM.yyyy')}"></td>
                    <td th:text="${grade.comment != null ? grade.comment : '-'}"></td>
                    <td>
                        <a th:href="@{/grades/{id}/delete(id=${grade.id})}" class="btn btn-danger btn-small" onclick="return confirm('Вы уверены?')">Удалить</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div th:if="${grades == null or grades.isEmpty()}" class="empty-state">
            <p>Оценки не найдены. Добавьте первую оценку.</p>
            <a href="/grades/new" class="btn">Добавить оценку</a>
        </div>
    </div>
</div>
</body>
</html>
